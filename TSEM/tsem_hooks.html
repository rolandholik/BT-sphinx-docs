<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Quixote" href="../Quixote/quixote.html" /><link rel="prev" title="TSEM" href="tsem.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>LSM Hooks - TSEM guide 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b0d4dec2" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">TSEM guide 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">TSEM guide 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="tsem.html">TSEM</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of TSEM</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">LSM Hooks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Quixote/quixote.html">Quixote</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Quixote</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Quixote/quixote_ker.html">quixote</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Quixote/quixote_us.html">quixote-us</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Quixote/quixote_export.html">quixote-export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Quixote/quixote_console.html">quixote-console</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Quixote/quixote_experiments.html">Quixote experiments</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/TSEM/tsem_hooks.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="lsm-hooks">
<h1>LSM Hooks<a class="headerlink" href="#lsm-hooks" title="Link to this heading">¶</a></h1>
<section id="detailed-description">
<span id="tsem-hooks"></span><h2>Detailed description<a class="headerlink" href="#detailed-description" title="Link to this heading">¶</a></h2>
<p>This section describes some of the <a class="reference internal" href="../glossary.html#term-LSM"><span class="xref std std-term">LSM</span></a> hooks <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> leverages.</p>
<p><a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> implements all together 111 LSM hooks with 109 unique functions —
<code class="docutils literal notranslate"><span class="pre">msg_queue_alloc_security</span></code>, <code class="docutils literal notranslate"><span class="pre">sem_alloc_security</span></code>, <code class="docutils literal notranslate"><span class="pre">shm_alloc_security</span></code> are
all handeled by same functions. Most of the functions basically populate
structures that hold characteristics of different security events, but there are also functions that don’t.</p>
</section>
<section id="generating-security-events-few-examples">
<h2>Generating security events (few examples)<a class="headerlink" href="#generating-security-events-few-examples" title="Link to this heading">¶</a></h2>
<p>This section describes hooks that populate <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> security event
structures with data. Most of the hooks in <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> do basically just that,
therefore most of the hooks I chose for this demonstration actually do a bit
more setting up.</p>
<section id="bprm-check-security">
<h3>bprm_check_security<a class="headerlink" href="#bprm-check-security" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">tsem_bprm_check_security</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">linux_binprm</span><span class="w"> </span><span class="o">*</span><span class="n">bprm</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_event</span><span class="w"> </span><span class="o">*</span><span class="n">ep</span><span class="p">;</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">static_branch_unlikely</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsem_not_ready</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bypass_event</span><span class="p">(</span><span class="n">TSEM_BPRM_CHECK_SECURITY</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_event_allocate</span><span class="p">(</span><span class="n">TSEM_BPRM_CHECK_SECURITY</span><span class="p">,</span><span class="w"> </span><span class="n">NOLOCK</span><span class="p">);</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ep</span><span class="p">)</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">bprm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bprm</span><span class="p">;</span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">dispatch_event</span><span class="p">(</span><span class="n">ep</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hooks is one of the simple ones. It checks if <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> is fully
initialized and if this function is modeled by the current namespace. If one
of the conditions is not true, it exits, granting permission without modeling
the event. It allocates structure holding data about binary handlers in
<a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> CELL structure and assigns the binary characteristics to it.
Afterwards, the hook models the event — deciding to deny or permit the
operation — and destroys the event structure.</p>
</section>
<section id="file-open">
<h3>file_open<a class="headerlink" href="#file-open" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">tsem_file_open</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">inode</span><span class="w"> </span><span class="o">*</span><span class="n">inode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file_inode</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_event</span><span class="w"> </span><span class="o">*</span><span class="n">ep</span><span class="p">;</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">static_branch_unlikely</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsem_not_ready</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bypass_event</span><span class="p">(</span><span class="n">TSEM_FILE_OPEN</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">inode</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TSEM_INODE_CONTROL_PLANE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">capable</span><span class="p">(</span><span class="n">CAP_MAC_ADMIN</span><span class="p">))</span>
<span class="w">                     </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">             </span><span class="k">else</span>
<span class="w">                     </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EPERM</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">S_ISREG</span><span class="p">(</span><span class="n">inode</span><span class="o">-&gt;</span><span class="n">i_mode</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">inode</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TSEM_INODE_COLLECTING</span><span class="p">)</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_event_allocate</span><span class="p">(</span><span class="n">TSEM_FILE_OPEN</span><span class="p">,</span><span class="w"> </span><span class="n">NOLOCK</span><span class="p">);</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ep</span><span class="p">)</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">in</span><span class="p">.</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="p">;</span>
<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">in</span><span class="p">.</span><span class="n">pseudo_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pseudo_filesystem</span><span class="p">(</span><span class="n">inode</span><span class="p">);</span>

<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">dispatch_event</span><span class="p">(</span><span class="n">ep</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hook checks if <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> is fully initialized and if this type of event
is modeled by the current namespace. If one of the conditions isn’t true, the
hook grants permission without modeling the event. If the file it tries to
access belongs to the <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> control plane and the process trying to open
the file has <code class="docutils literal notranslate"><span class="pre">CAP_MAC_ADMIN</span></code> capability set, the hook allows opening of the
file without modeling the event. If a process without <code class="docutils literal notranslate"><span class="pre">CAP_MAC_ADMIN</span></code>
capability tries to open control plane file, the hook denies the operation
without modeling the event. The hook allocates event structure holding data
about file in <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> CELL structure and assigns file characteristics from
the accesses file to it. Afterwards, the hook models the event — deciding to
deny or permit the operation — and destroys the event structure.</p>
</section>
<section id="mmap-file">
<h3>mmap_file<a class="headerlink" href="#mmap-file" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">tsem_mmap_file</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">prot</span><span class="p">,</span>
<span class="w">                       </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">extra</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">inode</span><span class="w"> </span><span class="o">*</span><span class="n">inode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_event</span><span class="w"> </span><span class="o">*</span><span class="n">ep</span><span class="p">;</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">static_branch_unlikely</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsem_not_ready</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bypass_event</span><span class="p">(</span><span class="n">TSEM_MMAP_FILE</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">file</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="p">(</span><span class="n">prot</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">PROT_EXEC</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">inode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file_inode</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">S_ISREG</span><span class="p">(</span><span class="n">inode</span><span class="o">-&gt;</span><span class="n">i_mode</span><span class="p">))</span>
<span class="w">                     </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pseudo_filesystem</span><span class="p">(</span><span class="n">inode</span><span class="p">))</span>
<span class="w">                     </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>

<span class="w">     </span><span class="n">ep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_event_allocate</span><span class="p">(</span><span class="n">TSEM_MMAP_FILE</span><span class="p">,</span><span class="w"> </span><span class="n">NOLOCK</span><span class="p">);</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ep</span><span class="p">)</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">mmap_file</span><span class="p">.</span><span class="n">anonymous</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">mmap_file</span><span class="p">.</span><span class="n">file</span><span class="p">.</span><span class="n">in</span><span class="p">.</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="p">;</span>
<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">mmap_file</span><span class="p">.</span><span class="n">prot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prot</span><span class="p">;</span>
<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">mmap_file</span><span class="p">.</span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flags</span><span class="p">;</span>

<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">dispatch_event</span><span class="p">(</span><span class="n">ep</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hook checks if <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> is fully initialized and if this type of event
is modeled by the current namespace. If one of the conditions isn’t true, the
hook grants permission without modeling the event. The hook checks and exits the
function, granting permission for further execution without modeling the event,
if there is no file provided to the hook and the mapping is not set executable
(e.g. anonymous mapping of shared memory). The hook allocates <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> event
structure for mmap_file characteristics and stores mmap_file related
characteristics to it. Afterwards, it models the event — deciding to deny or
permit the operation — and destroys the event structure.</p>
</section>
<section id="task-alloc">
<h3>task_alloc<a class="headerlink" href="#task-alloc" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">tsem_task_alloc</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">task_struct</span><span class="w"> </span><span class="o">*</span><span class="n">new</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_event</span><span class="w"> </span><span class="o">*</span><span class="n">ep</span><span class="p">;</span>

<span class="w">     </span><span class="n">tsem_task</span><span class="p">(</span><span class="n">new</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">tnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_task</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">tnum</span><span class="p">;</span>
<span class="w">     </span><span class="n">tsem_task</span><span class="p">(</span><span class="n">new</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_task</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">context</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_event_allocate</span><span class="p">(</span><span class="n">TSEM_TASK_ALLOC</span><span class="p">,</span><span class="w"> </span><span class="n">NOLOCK</span><span class="p">);</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ep</span><span class="p">)</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">task_args</span><span class="p">.</span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="p">;</span>
<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">task_args</span><span class="p">.</span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flags</span><span class="p">;</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tsem_context</span><span class="p">(</span><span class="n">new</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">)</span>
<span class="w">             </span><span class="n">kref_get</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsem_task</span><span class="p">(</span><span class="n">new</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">context</span><span class="o">-&gt;</span><span class="n">kref</span><span class="p">);</span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">dispatch_event</span><span class="p">(</span><span class="n">ep</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hook assigns serial number (tnum) and modeling namespace (context) to the
new taks. It allocates <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> event structure for task_alloc event
characteristics and stores task_alloc related characteristics to it. If the new
task has valid id it increments reference count for the task. Afterwards, the
hook models the event — deciding to deny or permit the operation — and
destroys the event structure.</p>
</section>
<section id="task-free">
<h3>task_free<a class="headerlink" href="#task-free" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">tsem_task_free</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">task_struct</span><span class="w"> </span><span class="o">*</span><span class="n">task</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_event</span><span class="w"> </span><span class="n">ep</span><span class="p">;</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_context</span><span class="w"> </span><span class="o">*</span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_context</span><span class="p">(</span><span class="n">task</span><span class="p">);</span>

<span class="w">     </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ep</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">ep</span><span class="p">));</span>
<span class="w">     </span><span class="n">ep</span><span class="p">.</span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TSEM_TASK_FREE</span><span class="p">;</span>
<span class="w">     </span><span class="n">ep</span><span class="p">.</span><span class="n">CELL</span><span class="p">.</span><span class="n">task_args</span><span class="p">.</span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">task</span><span class="p">;</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">likely</span><span class="p">(</span><span class="o">!</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">ops</span><span class="o">-&gt;</span><span class="n">event_init</span><span class="p">))</span>
<span class="w">             </span><span class="n">tsem_event_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ep</span><span class="p">);</span>
<span class="w">     </span><span class="k">else</span>
<span class="w">             </span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">ops</span><span class="o">-&gt;</span><span class="n">event_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ep</span><span class="p">);</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">)</span>
<span class="w">             </span><span class="n">tsem_ns_put</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
<span class="w">     </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="n">tsem_tma_context</span><span class="p">(</span><span class="n">task</span><span class="p">)))</span>
<span class="w">             </span><span class="n">tsem_ns_put</span><span class="p">(</span><span class="n">tsem_tma_context</span><span class="p">(</span><span class="n">task</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hook sets its event structure to zeros, populates it with
<code class="docutils literal notranslate"><span class="pre">TSEM_TASK_FREE</span></code> related characteristics and releases its kernel reference
from the modeling namespace of the task. This hook does not explicitly grant or
deny access as it’s a void function.</p>
</section>
<section id="task-kill">
<h3>task_kill<a class="headerlink" href="#task-kill" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">tsem_task_kill</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">task_struct</span><span class="w"> </span><span class="o">*</span><span class="n">target</span><span class="p">,</span>
<span class="w">                       </span><span class="k">struct</span><span class="w"> </span><span class="nc">kernel_siginfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">sig</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">cred</span><span class="w"> </span><span class="o">*</span><span class="n">cred</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="kt">bool</span><span class="w"> </span><span class="n">cross_model</span><span class="p">;</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_event</span><span class="w"> </span><span class="o">*</span><span class="n">ep</span><span class="p">;</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_context</span><span class="w"> </span><span class="o">*</span><span class="n">src_ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_context</span><span class="p">(</span><span class="n">current</span><span class="p">);</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_context</span><span class="w"> </span><span class="o">*</span><span class="n">tgt_ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_context</span><span class="p">(</span><span class="n">target</span><span class="p">);</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bypass_event</span><span class="p">(</span><span class="n">TSEM_TASK_KILL</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">     </span><span class="n">cross_model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">src_ctx</span><span class="o">-&gt;</span><span class="n">id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">tgt_ctx</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">;</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SEND_SIG_NOINFO</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">SI_FROMKERNEL</span><span class="p">(</span><span class="n">info</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sig</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SIGURG</span><span class="p">)</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">capable</span><span class="p">(</span><span class="n">CAP_MAC_ADMIN</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">         </span><span class="n">has_capability_noaudit</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">CAP_MAC_ADMIN</span><span class="p">))</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EPERM</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">capable</span><span class="p">(</span><span class="n">CAP_MAC_ADMIN</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cross_model</span><span class="p">)</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EPERM</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_event_allocate</span><span class="p">(</span><span class="n">TSEM_TASK_KILL</span><span class="p">,</span><span class="w"> </span><span class="n">LOCK</span><span class="p">);</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ep</span><span class="p">)</span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">task_kill</span><span class="p">.</span><span class="n">signal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig</span><span class="p">;</span>
<span class="w">     </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">task_kill</span><span class="p">.</span><span class="n">cross_model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cross_model</span><span class="p">;</span>
<span class="w">     </span><span class="n">memcpy</span><span class="p">(</span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">CELL</span><span class="p">.</span><span class="n">task_kill</span><span class="p">.</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">tsem_task</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">task_id</span><span class="p">,</span>
<span class="w">            </span><span class="n">tsem_digestsize</span><span class="p">());</span>

<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">dispatch_event</span><span class="p">(</span><span class="n">ep</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hook acquires namespace context for current task (the one sending the kill
signal ) and target task (the one that is to be killed). If <code class="docutils literal notranslate"><span class="pre">task_kill</span></code> isn’t
modeled by the current namespace, the kill signal originates from kernel or it’s
urgent signal, the hook exits, granting permission without modeling the event.
If the task initiating the killing doesn’t have <code class="docutils literal notranslate"><span class="pre">CAP_MAC_ADMIN</span></code> and the target
task does or if the task initiating the killing doesn’t have <code class="docutils literal notranslate"><span class="pre">CAP_MAC_ADMIN</span></code>
and the kill signal is sent to task from another modling namespace, it returns
permission denied, without modeling the event. The hook allocates <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a>
event structure holding data about <code class="docutils literal notranslate"><span class="pre">task_kill</span></code>, populates it with task kill
characteristics and models the event — deciding to grant or deny permission
— and destroys the event structure.</p>
</section>
</section>
<section id="not-generating-security-events">
<h2>Not generating security events<a class="headerlink" href="#not-generating-security-events" title="Link to this heading">¶</a></h2>
<p>The following hooks don’t do any modeling related operations and don’t
grant/deny permissions. They only manage structures needed for proper
functioning of <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> <a class="reference internal" href="../glossary.html#term-LSM"><span class="xref std std-term">LSM</span></a>.</p>
<section id="inode-alloc-security">
<span id="inode-alloc-security-r"></span><h3>inode_alloc_security<a class="headerlink" href="#inode-alloc-security" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">tsem_inode_alloc_security</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">inode</span><span class="w"> </span><span class="o">*</span><span class="n">inode</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_inode</span><span class="w"> </span><span class="o">*</span><span class="n">tsip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">inode</span><span class="p">);</span>

<span class="w">    </span><span class="n">mutex_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">digest_mutex</span><span class="p">);</span>
<span class="w">    </span><span class="n">INIT_LIST_HEAD</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">digest_list</span><span class="p">);</span>

<span class="w">    </span><span class="n">mutex_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">create_mutex</span><span class="p">);</span>
<span class="w">    </span><span class="n">INIT_LIST_HEAD</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">create_list</span><span class="p">);</span>

<span class="w">    </span><span class="n">mutex_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">instance_mutex</span><span class="p">);</span>
<span class="w">    </span><span class="n">INIT_LIST_HEAD</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">instance_list</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt>This hook initializes linked lists holding structures with:</dt><dd><ul class="simple">
<li><p>digests calculated for the inode</p></li>
<li><p>information about inodes created under a directory</p></li>
<li><p>task identities that have created inodes under a directory</p></li>
</ul>
</dd>
</dl>
</section>
<section id="inode-init-security">
<h3>inode_init_security<a class="headerlink" href="#inode-init-security" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">tsem_inode_init_security</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">inode</span><span class="w"> </span><span class="o">*</span><span class="n">inode</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">inode</span><span class="w"> </span><span class="o">*</span><span class="n">dir</span><span class="p">,</span>
<span class="w">                                 </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">qstr</span><span class="w"> </span><span class="o">*</span><span class="n">qstr</span><span class="p">,</span>
<span class="w">                                 </span><span class="k">struct</span><span class="w"> </span><span class="nc">xattr</span><span class="w"> </span><span class="o">*</span><span class="n">xattrs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">xattr_count</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_task</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">task_id</span><span class="p">;</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_inode</span><span class="w"> </span><span class="o">*</span><span class="n">tsip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">inode</span><span class="p">);</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_inode_instance</span><span class="w"> </span><span class="o">*</span><span class="n">entry</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">retn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">     </span><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">create_mutex</span><span class="p">);</span>
<span class="w">     </span><span class="n">list_for_each_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">create_list</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">memcmp</span><span class="p">(</span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">tsem_digestsize</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                 </span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">qstr</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">pathname</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                     </span><span class="n">retn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="p">;</span>
<span class="w">                     </span><span class="k">break</span><span class="p">;</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">     </span><span class="p">}</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">retn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">backing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ERR_PTR</span><span class="p">(</span><span class="o">-</span><span class="n">ENOENT</span><span class="p">);</span>
<span class="w">             </span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">created</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">             </span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">creator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retn</span><span class="o">-&gt;</span><span class="n">creator</span><span class="p">;</span>
<span class="w">             </span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retn</span><span class="o">-&gt;</span><span class="n">instance</span><span class="p">;</span>
<span class="w">             </span><span class="n">memcpy</span><span class="p">(</span><span class="n">tsip</span><span class="o">-&gt;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">retn</span><span class="o">-&gt;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">tsem_digestsize</span><span class="p">());</span>

<span class="w">             </span><span class="n">list_del</span><span class="p">(</span><span class="o">&amp;</span><span class="n">retn</span><span class="o">-&gt;</span><span class="n">list</span><span class="p">);</span>
<span class="w">             </span><span class="n">__putname</span><span class="p">(</span><span class="n">retn</span><span class="o">-&gt;</span><span class="n">pathname</span><span class="p">);</span>
<span class="w">             </span><span class="n">kfree</span><span class="p">(</span><span class="n">retn</span><span class="p">);</span>
<span class="w">     </span><span class="p">}</span>
<span class="w">     </span><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">create_mutex</span><span class="p">);</span>

<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EOPNOTSUPP</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hook searches in the directory parent directory of the inode that is meant
to have its security related data initialized. If found the hook initializes the
tsem_inode structure with <a class="reference internal" href="../glossary.html#term-TSEM"><span class="xref std std-term">TSEM</span></a> security related credentials of the
current task.</p>
</section>
<section id="inode-free-security">
<h3>inode_free_security<a class="headerlink" href="#inode-free-security" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">tsem_inode_free_security</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">inode</span><span class="w"> </span><span class="o">*</span><span class="n">inode</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_inode_instance</span><span class="w"> </span><span class="o">*</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">tmp_owner</span><span class="p">;</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_inode_digest</span><span class="w"> </span><span class="o">*</span><span class="n">digest</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">tmp_digest</span><span class="p">;</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_inode_entry</span><span class="w"> </span><span class="o">*</span><span class="n">entry</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">tmp_entry</span><span class="p">;</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_context</span><span class="w"> </span><span class="o">*</span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_context</span><span class="p">(</span><span class="n">current</span><span class="p">);</span>

<span class="w">     </span><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">inode_mutex</span><span class="p">);</span>
<span class="w">     </span><span class="n">list_for_each_entry_safe</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span><span class="w"> </span><span class="n">tmp_entry</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">inode_list</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">tsip</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">inode</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                     </span><span class="n">list_del</span><span class="p">(</span><span class="o">&amp;</span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">list</span><span class="p">);</span>
<span class="w">                     </span><span class="n">_release_inode_instances</span><span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">tsip</span><span class="p">);</span>
<span class="w">                     </span><span class="n">kfree</span><span class="p">(</span><span class="n">entry</span><span class="p">);</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">     </span><span class="p">}</span>
<span class="w">     </span><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">inode_mutex</span><span class="p">);</span>

<span class="w">     </span><span class="n">list_for_each_entry_safe</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span><span class="w"> </span><span class="n">tmp_digest</span><span class="p">,</span>
<span class="w">                              </span><span class="o">&amp;</span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">inode</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">digest_list</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">list_del</span><span class="p">(</span><span class="o">&amp;</span><span class="n">digest</span><span class="o">-&gt;</span><span class="n">list</span><span class="p">);</span>
<span class="w">             </span><span class="n">kfree</span><span class="p">(</span><span class="n">digest</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">             </span><span class="n">kfree</span><span class="p">(</span><span class="n">digest</span><span class="p">);</span>
<span class="w">     </span><span class="p">}</span>

<span class="w">     </span><span class="n">list_for_each_entry_safe</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">tmp_owner</span><span class="p">,</span>
<span class="w">                              </span><span class="o">&amp;</span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">inode</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">create_list</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">list_del</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="o">-&gt;</span><span class="n">list</span><span class="p">);</span>
<span class="w">             </span><span class="n">kfree</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">     </span><span class="p">}</span>

<span class="w">     </span><span class="n">list_for_each_entry_safe</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">tmp_owner</span><span class="p">,</span>
<span class="w">                              </span><span class="o">&amp;</span><span class="n">tsem_inode</span><span class="p">(</span><span class="n">inode</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">instance_list</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">list_del</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="o">-&gt;</span><span class="n">list</span><span class="p">);</span>
<span class="w">             </span><span class="n">kfree</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">     </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hook clears data in the three lists that <a class="reference internal" href="#inode-alloc-security-r"><span class="std std-ref">inode_alloc_security</span></a> initializes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The data in those lists get filled in hooks that didn’t get covered by this
page. <a class="reference internal" href="#inode-alloc-security-r"><span class="std std-ref">inode_alloc_security</span></a> only initializes
the lists.</p>
</div>
</section>
<section id="managed-by-same-function">
<h3>Managed by same function<a class="headerlink" href="#managed-by-same-function" title="Link to this heading">¶</a></h3>
<p>The tsem_ipc_alloc hook gets mapped to three different <a class="reference internal" href="../glossary.html#term-LSM"><span class="xref std std-term">LSM</span></a> hooks.</p>
<section id="msg-queue-alloc-security-sem-alloc-security-shm-alloc-security">
<h4>msg_queue_alloc_security, sem_alloc_security, shm_alloc_security<a class="headerlink" href="#msg-queue-alloc-security-sem-alloc-security-shm-alloc-security" title="Link to this heading">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">tsem_ipc_alloc</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">kern_ipc_perm</span><span class="w"> </span><span class="o">*</span><span class="n">kipc</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="k">struct</span><span class="w"> </span><span class="nc">tsem_ipc</span><span class="w"> </span><span class="o">*</span><span class="n">tipc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsem_ipc</span><span class="p">(</span><span class="n">kipc</span><span class="p">);</span>

<span class="w">     </span><span class="n">memcpy</span><span class="p">(</span><span class="n">tipc</span><span class="o">-&gt;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">tsem_task</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">task_id</span><span class="p">,</span><span class="w"> </span><span class="n">tsem_digestsize</span><span class="p">());</span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This hook simply assigns id of the task that created the <a class="reference internal" href="../glossary.html#term-IPC"><span class="xref std std-term">IPC</span></a> resource to
the tsem_ipc structure of the resource. Data in this structure is important for
modeling of hooks that utilize the resource.</p>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../Quixote/quixote.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Quixote</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="tsem.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">TSEM</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Roland Holik
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">LSM Hooks</a><ul>
<li><a class="reference internal" href="#detailed-description">Detailed description</a></li>
<li><a class="reference internal" href="#generating-security-events-few-examples">Generating security events (few examples)</a><ul>
<li><a class="reference internal" href="#bprm-check-security">bprm_check_security</a></li>
<li><a class="reference internal" href="#file-open">file_open</a></li>
<li><a class="reference internal" href="#mmap-file">mmap_file</a></li>
<li><a class="reference internal" href="#task-alloc">task_alloc</a></li>
<li><a class="reference internal" href="#task-free">task_free</a></li>
<li><a class="reference internal" href="#task-kill">task_kill</a></li>
</ul>
</li>
<li><a class="reference internal" href="#not-generating-security-events">Not generating security events</a><ul>
<li><a class="reference internal" href="#inode-alloc-security">inode_alloc_security</a></li>
<li><a class="reference internal" href="#inode-init-security">inode_init_security</a></li>
<li><a class="reference internal" href="#inode-free-security">inode_free_security</a></li>
<li><a class="reference internal" href="#managed-by-same-function">Managed by same function</a><ul>
<li><a class="reference internal" href="#msg-queue-alloc-security-sem-alloc-security-shm-alloc-security">msg_queue_alloc_security, sem_alloc_security, shm_alloc_security</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=283e6f7d"></script>
    </body>
</html>