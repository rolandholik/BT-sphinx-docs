<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Execute mode" href="execute_mode.html" /><link rel="prev" title="Process mode" href="process_mode.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Container mode - TSEM guide 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b0d4dec2" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">TSEM guide 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">TSEM guide 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../TSEM/tsem.html">TSEM</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of TSEM</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../TSEM/tsem_hooks.html">LSM Hooks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Quixote/quixote.html">Quixote</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Quixote</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Quixote/quixote_ker.html">quixote</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Quixote/quixote_us.html">quixote-us</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Quixote/quixote_export.html">quixote-export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Quixote/quixote_console.html">quixote-console</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="overview.html">Quixote experiments</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Quixote experiments</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="process_mode.html">Process mode</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Container mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="execute_mode.html">Execute mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="export_mode.html">Export mode</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/QuixoteExperiments/container_mode.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="container-mode">
<h1>Container mode<a class="headerlink" href="#container-mode" title="Link to this heading">¶</a></h1>
<p id="id1">In container mode we experimented with modeling of two containers: minimalistic
Debian Buster container and Apache web server container.</p>
<section id="minimalistic-debain-buster">
<h2>Minimalistic Debain Buster<a class="headerlink" href="#minimalistic-debain-buster" title="Link to this heading">¶</a></h2>
<p>We started by generating the model running <code class="docutils literal notranslate"><span class="pre">ls</span></code> command and then exiting the
workload.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>buster<span class="w"> </span>-o<span class="w"> </span>buster.model
<span class="gp"># </span>ls
<span class="go">bin   dev  home  lib32       libx32  mnt  proc  run  srv  tmp  var</span>
<span class="go">boot  etc  lib       lib64   media   opt  root  sbin  sys  usr</span>
<span class="gp">#</span>
<span class="go">Wrote security model to: buster.model</span>
</pre></div>
</div>
<p>Afterwards we enforced the model and ran the <code class="docutils literal notranslate"><span class="pre">ls</span></code> command.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>buster<span class="w"> </span>-o<span class="w"> </span>buster.model
<span class="gp"># </span>ls
<span class="go">bin   dev  home  lib32       libx32  mnt  proc  run  srv  tmp  var</span>
<span class="go">boot  etc  lib       lib64   media   opt  root  sbin  sys  usr</span>
<span class="gp">#</span>
<span class="go">Wrote security model to: buster.model</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>buster<span class="w"> </span>-m<span class="w"> </span>buster.model<span class="w"> </span>-e
<span class="gp"># </span>ls
<span class="go">bin   dev  home  lib32       libx32  mnt  proc  run  srv  tmp  var</span>
<span class="go">boot  etc  lib       lib64   media   opt  root  sbin  sys  usr</span>
</pre></div>
</div>
<p>It got permitted.</p>
<p>Then we ran process monitoring tool <code class="docutils literal notranslate"><span class="pre">top</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>buster<span class="w"> </span>-o<span class="w"> </span>buster.model
<span class="gp"># </span>ls
<span class="go">bin   dev  home  lib32       libx32  mnt  proc  run  srv  tmp  var</span>
<span class="go">boot  etc  lib       lib64   media   opt  root  sbin  sys  usr</span>
<span class="gp">#</span>
<span class="go">Wrote security model to: buster.model</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>buster<span class="w"> </span>-m<span class="w"> </span>buster.model<span class="w"> </span>-e
<span class="gp"># </span>ls
<span class="go">bin   dev  home  lib32       libx32  mnt  proc  run  srv  tmp  var</span>
<span class="go">boot  etc  lib       lib64   media   opt  root  sbin  sys  usr</span>
<span class="gp"># </span>top
<span class="go">sh: 2: Cannot fork</span>
<span class="gp"># </span>ls
<span class="go">sh: 3: Cannot fork</span>
<span class="gp">#</span>
</pre></div>
</div>
<p>It got denied. What is more interesting, to note, is that running <code class="docutils literal notranslate"><span class="pre">ls</span></code> again
got denied.</p>
</section>
<section id="apache-web-server">
<h2>Apache web server<a class="headerlink" href="#apache-web-server" title="Link to this heading">¶</a></h2>
<p>Since running just a bare-bones container is not too useful, we also tried to
model a container running Apache Web Server.</p>
<p>We launched the container in order to create the model.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-o<span class="w"> </span>httpd.model
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">[Tue Jun 03 06:37:04.248420 2025] [mpm_event:notice] [pid 1:tid 1] AH00489: Apache</span>
<span class="go">/2.4.63 (Unix) configured -- resuming normal operations</span>
<span class="go">[Tue Jun 03 06:37:04.249136 2025] [core:notice] [pid 1:tid 1] AH00094: Command</span>
<span class="go">line: ’httpd -D FOREGROUND’</span>
<span class="go">127.0.0.1 - - [03/Jun/2025:06:37:36 +0000] &quot;GET / HTTP/1.1&quot; 304 -</span>
<span class="go">^C[Tue Jun 03 06:39:02.019698 2025] [mpm_event:notice] [pid 1:tid 1] AH00491:</span>
<span class="go">caught SIGTERM, shutting down</span>
<span class="go">Wrote security model to: httpd.model</span>
</pre></div>
</div>
<p>Afterwards, we tired to enforce the model.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-o<span class="w"> </span>httpd.model
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">[Tue Jun 03 06:37:04.248420 2025] [mpm_event:notice] [pid 1:tid 1] AH00489: Apache</span>
<span class="go">/2.4.63 (Unix) configured -- resuming normal operations</span>
<span class="go">[Tue Jun 03 06:37:04.249136 2025] [core:notice] [pid 1:tid 1] AH00094: Command</span>
<span class="go">line: ’httpd -D FOREGROUND’</span>
<span class="go">127.0.0.1 - - [03/Jun/2025:06:37:36 +0000] &quot;GET / HTTP/1.1&quot; 304 -</span>
<span class="go">^C[Tue Jun 03 06:39:02.019698 2025] [mpm_event:notice] [pid 1:tid 1] AH00491:</span>
<span class="go">caught SIGTERM, shutting down</span>
<span class="go">Wrote security model to: httpd.model</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model<span class="w"> </span>-e
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to terminate initProcess&quot;</span>
<span class="go">error=&quot;operation not permitted&quot;</span>
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to destroy container: unable</span>
<span class="go">to remove container’s cgroup: rmdir /sys/fs/cgroup/user.slice/user-1000.slice</span>
<span class="go">/httpd: operation not permitted&quot;</span>
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=error msg=&quot;runc run failed: unable to start</span>
<span class="go">container process: error during container init: procReady not received&quot;</span>
</pre></div>
</div>
<p>We were met with permission denial.</p>
<p>To see what went wrong, we ran the workload again, but this time only in sealed
mode, so that we could examine what caused the denial.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-o<span class="w"> </span>httpd.model
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">[Tue Jun 03 06:37:04.248420 2025] [mpm_event:notice] [pid 1:tid 1] AH00489: Apache</span>
<span class="go">/2.4.63 (Unix) configured -- resuming normal operations</span>
<span class="go">[Tue Jun 03 06:37:04.249136 2025] [core:notice] [pid 1:tid 1] AH00094: Command</span>
<span class="go">line: ’httpd -D FOREGROUND’</span>
<span class="go">127.0.0.1 - - [03/Jun/2025:06:37:36 +0000] &quot;GET / HTTP/1.1&quot; 304 -</span>
<span class="go">^C[Tue Jun 03 06:39:02.019698 2025] [mpm_event:notice] [pid 1:tid 1] AH00491:</span>
<span class="go">caught SIGTERM, shutting down</span>
<span class="go">Wrote security model to: httpd.model</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model<span class="w"> </span>-e
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to terminate initProcess&quot;</span>
<span class="go">error=&quot;operation not permitted&quot;</span>
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to destroy container: unable</span>
<span class="go">to remove container’s cgroup: rmdir /sys/fs/cgroup/user.slice/user-1000.slice</span>
<span class="go">/httpd: operation not permitted&quot;</span>
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=error msg=&quot;runc run failed: unable to start</span>
<span class="go">container process: error during container init: procReady not received&quot;</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model
<span class="go">ERRO[0000] runc run failed: container with given ID already exists</span>
</pre></div>
</div>
<p>We were met with following error. As we can see in the previous output, the
contained didn’t get destroyed, so it was left hanging in initialization stage.
Therefore we had to delete the container.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-o<span class="w"> </span>httpd.model
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">[Tue Jun 03 06:37:04.248420 2025] [mpm_event:notice] [pid 1:tid 1] AH00489: Apache</span>
<span class="go">/2.4.63 (Unix) configured -- resuming normal operations</span>
<span class="go">[Tue Jun 03 06:37:04.249136 2025] [core:notice] [pid 1:tid 1] AH00094: Command</span>
<span class="go">line: ’httpd -D FOREGROUND’</span>
<span class="go">127.0.0.1 - - [03/Jun/2025:06:37:36 +0000] &quot;GET / HTTP/1.1&quot; 304 -</span>
<span class="go">^C[Tue Jun 03 06:39:02.019698 2025] [mpm_event:notice] [pid 1:tid 1] AH00491:</span>
<span class="go">caught SIGTERM, shutting down</span>
<span class="go">Wrote security model to: httpd.model</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model<span class="w"> </span>-e
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to terminate initProcess&quot;</span>
<span class="go">error=&quot;operation not permitted&quot;</span>
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to destroy container: unable</span>
<span class="go">to remove container’s cgroup: rmdir /sys/fs/cgroup/user.slice/user-1000.slice</span>
<span class="go">/httpd: operation not permitted&quot;</span>
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=error msg=&quot;runc run failed: unable to start</span>
<span class="go">container process: error during container init: procReady not received&quot;</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model
<span class="go">ERRO[0000] runc run failed: container with given ID already exists</span>
<span class="gp"># </span>runc<span class="w"> </span>delete<span class="w"> </span>httpd
<span class="go">ERRO[0000] container does not exist</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">runc</span></code> gave us the same error, but it destroyed the uninitialized
contained in the background and we were able to relaunch the workload in sealed
mode.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-o<span class="w"> </span>httpd.model
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">[Tue Jun 03 06:37:04.248420 2025] [mpm_event:notice] [pid 1:tid 1] AH00489: Apache</span>
<span class="go">/2.4.63 (Unix) configured -- resuming normal operations</span>
<span class="go">[Tue Jun 03 06:37:04.249136 2025] [core:notice] [pid 1:tid 1] AH00094: Command</span>
<span class="go">line: ’httpd -D FOREGROUND’</span>
<span class="go">127.0.0.1 - - [03/Jun/2025:06:37:36 +0000] &quot;GET / HTTP/1.1&quot; 304 -</span>
<span class="go">^C[Tue Jun 03 06:39:02.019698 2025] [mpm_event:notice] [pid 1:tid 1] AH00491:</span>
<span class="go">caught SIGTERM, shutting down</span>
<span class="go">Wrote security model to: httpd.model</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model<span class="w"> </span>-e
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to terminate initProcess&quot;</span>
<span class="go">error=&quot;operation not permitted&quot;</span>
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to destroy container: unable</span>
<span class="go">to remove container’s cgroup: rmdir /sys/fs/cgroup/user.slice/user-1000.slice</span>
<span class="go">/httpd: operation not permitted&quot;</span>
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=error msg=&quot;runc run failed: unable to start</span>
<span class="go">container process: error during container init: procReady not received&quot;</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model
<span class="go">ERRO[0000] runc run failed: container with given ID already exists</span>
<span class="gp"># </span>runc<span class="w"> </span>delete<span class="w"> </span>httpd
<span class="go">ERRO[0000] container does not exist</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default AH00558:</span>
<span class="go">httpd: Could not reliably determine the server&#39;s fully qualified domain name,</span>
<span class="go">using 127.0.0.1. Set the &#39;ServerName&#39; directive globally to suppress this</span>
<span class="go">message AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server&#39;s fully qualified</span>
<span class="go">domain name, using 127.0.0.1. Set the &#39;ServerName&#39; directive globally to</span>
<span class="go">suppress this message [Tue Jun 03 06:47:15.256134 2025] [mpm_event:notice]</span>
<span class="go">[pid 1:tid 1] AH00489: Apache/2.4.63 (Unix) configured -- resuming normal</span>
<span class="go">operations [Tue Jun 03 06:47:15.739326 2025] [core:notice] [pid 1:tid 1]</span>
<span class="go">AH00094: Command line: &#39;httpd -D FOREGROUND</span>
</pre></div>
</div>
<p>In a second terminal, we examined the total of 68 forensic events. Here are the
first  Here are the first four of them for illustration.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote-console<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-F<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq
<span class="go">{&quot;event&quot;: {&quot;context&quot;: &quot;14&quot;, &quot;number&quot;: &quot;343&quot;, &quot;process&quot;: &quot;runc:[2:INIT]&quot;,</span>
<span class="go">&quot;type&quot;: &quot;inode_getattr&quot;, &quot;ttd&quot;: &quot;3052&quot;, &quot;p_ttd&quot;: &quot;3052&quot;, &quot;task_id&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;,</span>
<span class="go">&quot;p_task_id&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;, &quot;ts&quot;:</span>
<span class="go">&quot;847743223&quot;}, &quot;COE&quot;: {&quot;uid&quot;: &quot;0&quot;, &quot;euid&quot;: &quot;0&quot;, &quot;suid&quot;: &quot;0&quot;, &quot;gid&quot;: &quot;0&quot;,</span>
<span class="go">&quot;egid&quot;: &quot;0&quot;, &quot;sgid&quot;: &quot;0&quot;, &quot;fsuid&quot;: &quot;0&quot;, &quot;fsgid&quot;: &quot;0&quot;, &quot;capeff&quot;:</span>
<span class="go">&quot;0x1fdffffffff&quot;}, &quot;inode_getattr&quot;: {&quot;path&quot;: {&quot;inode&quot;: {&quot;uid&quot;: &quot;0&quot;, &quot;gid&quot;:</span>
<span class="go">&quot;0&quot;, &quot;mode&quot;: &quot;040755&quot;, &quot;s_magic&quot;: &quot;0x1021994&quot;, &quot;s_id&quot;: &quot;tmpfs&quot;, &quot;s_uuid&quot;:</span>
<span class="go">&quot;e57e8eaab02749c7a48b835d9c4c10a9&quot;}, &quot;path&quot;: {&quot;dev&quot;: {&quot;major&quot;: &quot;0&quot;, &quot;minor&quot;:</span>
<span class="go">&quot;75&quot;}, &quot;type&quot;: &quot;namespace&quot;, &quot;pathname&quot;:</span>
<span class="go">&quot;/var/lib/Quixote/Magazine/httpd/rootfs/dev&quot;}}}} {&quot;event&quot;: {&quot;context&quot;: &quot;14&quot;,</span>
<span class="go">&quot;number&quot;: &quot;344&quot;, &quot;process&quot;: &quot;runc:[2:INIT]&quot;, &quot;type&quot;: &quot;file_fcntl&quot;, &quot;ttd&quot;:</span>
<span class="go">&quot;3052&quot;, &quot;p_ttd&quot;: &quot;3052&quot;, &quot;task_id&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;,</span>
<span class="go">&quot;p_task_id&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;, &quot;ts&quot;:</span>
<span class="go">&quot;847778102&quot;}, &quot;COE&quot;: {&quot;uid&quot;: &quot;0&quot;, &quot;euid&quot;: &quot;0&quot;, &quot;suid&quot;: &quot;0&quot;, &quot;gid&quot;: &quot;0&quot;,</span>
<span class="go">&quot;egid&quot;: &quot;0&quot;, &quot;sgid&quot;: &quot;0&quot;, &quot;fsuid&quot;: &quot;0&quot;, &quot;fsgid&quot;: &quot;0&quot;, &quot;capeff&quot;:</span>
<span class="go">&quot;0x1fdffffffff&quot;}, &quot;file_fcntl&quot;: {&quot;file&quot;: {&quot;flags&quot;: &quot;2097152&quot;, &quot;inode&quot;:</span>
<span class="go">{&quot;uid&quot;: &quot;0&quot;, &quot;gid&quot;: &quot;0&quot;, &quot;mode&quot;: &quot;040755&quot;, &quot;s_magic&quot;: &quot;0x1021994&quot;, &quot;s_id&quot;:</span>
<span class="go">&quot;tmpfs&quot;, &quot;s_uuid&quot;: &quot;e57e8eaab02749c7a48b835d9c4c10a9&quot;}, &quot;path&quot;: {&quot;dev&quot;:</span>
<span class="go">{&quot;major&quot;: &quot;0&quot;, &quot;minor&quot;: &quot;75&quot;}, &quot;type&quot;: &quot;namespace&quot;, &quot;pathname&quot;:</span>
<span class="go">&quot;/var/lib/Quixote/Magazine/httpd/rootfs/dev&quot;}, &quot;digest&quot;:</span>
<span class="go">&quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855&quot;}, &quot;cmd&quot;:</span>
<span class="go">&quot;3&quot;}} {&quot;event&quot;: {&quot;context&quot;: &quot;14&quot;, &quot;number&quot;: &quot;358&quot;, &quot;process&quot;:</span>
<span class="go">&quot;runc:[2:INIT]&quot;, &quot;type&quot;: &quot;file_fcntl&quot;, &quot;ttd&quot;: &quot;3052&quot;, &quot;p_ttd&quot;: &quot;3052&quot;,</span>
<span class="go">&quot;task_id&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;,</span>
<span class="go">&quot;p_task_id&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;, &quot;ts&quot;:</span>
<span class="go">&quot;848047872&quot;}, &quot;COE&quot;: {&quot;uid&quot;: &quot;0&quot;, &quot;euid&quot;: &quot;0&quot;, &quot;suid&quot;: &quot;0&quot;, &quot;gid&quot;: &quot;0&quot;,</span>
<span class="go">&quot;egid&quot;: &quot;0&quot;, &quot;sgid&quot;: &quot;0&quot;, &quot;fsuid&quot;: &quot;0&quot;, &quot;fsgid&quot;: &quot;0&quot;, &quot;capeff&quot;:</span>
<span class="go">&quot;0x1fdffffffff&quot;}, &quot;file_fcntl&quot;: {&quot;file&quot;: {&quot;flags&quot;: &quot;98304&quot;, &quot;inode&quot;: {&quot;uid&quot;:</span>
<span class="go">&quot;0&quot;, &quot;gid&quot;: &quot;0&quot;, &quot;mode&quot;: &quot;040755&quot;, &quot;s_magic&quot;: &quot;0x1021994&quot;, &quot;s_id&quot;: &quot;tmpfs&quot;,</span>
<span class="go">&quot;s_uuid&quot;: &quot;e57e8eaab02749c7a48b835d9c4c10a9&quot;}, &quot;path&quot;: {&quot;dev&quot;: {&quot;major&quot;: &quot;0&quot;,</span>
<span class="go">&quot;minor&quot;: &quot;75&quot;}, &quot;type&quot;: &quot;namespace&quot;, &quot;pathname&quot;:</span>
<span class="go">&quot;/var/lib/Quixote/Magazine/httpd/rootfs/dev&quot;}, &quot;digest&quot;:</span>
<span class="go">&quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855&quot;}, &quot;cmd&quot;:</span>
<span class="go">&quot;3&quot;}} {&quot;event&quot;: {&quot;context&quot;: &quot;14&quot;, &quot;number&quot;: &quot;359&quot;, &quot;process&quot;:</span>
<span class="go">&quot;runc:[2:INIT]&quot;, &quot;type&quot;: &quot;inode_mkdir&quot;, &quot;ttd&quot;: &quot;3052&quot;, &quot;p_ttd&quot;: &quot;3052&quot;,</span>
<span class="go">&quot;task_id&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;,</span>
<span class="go">&quot;p_task_id&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;, &quot;ts&quot;:</span>
<span class="go">&quot;848064933&quot;}, &quot;COE&quot;: {&quot;uid&quot;: &quot;0&quot;, &quot;euid&quot;: &quot;0&quot;, &quot;suid&quot;: &quot;0&quot;, &quot;gid&quot;: &quot;0&quot;,</span>
<span class="go">&quot;egid&quot;: &quot;0&quot;, &quot;sgid&quot;: &quot;0&quot;, &quot;fsuid&quot;: &quot;0&quot;, &quot;fsgid&quot;: &quot;0&quot;, &quot;capeff&quot;:</span>
<span class="go">&quot;0x1fdffffffff&quot;}, &quot;inode_mkdir&quot;: {&quot;dir&quot;: {&quot;uid&quot;: &quot;0&quot;, &quot;gid&quot;: &quot;0&quot;, &quot;mode&quot;:</span>
<span class="go">&quot;040755&quot;, &quot;s_magic&quot;: &quot;0x1021994&quot;, &quot;s_id&quot;: &quot;tmpfs&quot;, &quot;s_uuid&quot;:</span>
<span class="go">&quot;e57e8eaab02749c7a48b835d9c4c10a9&quot;}, &quot;dentry&quot;: {&quot;path&quot;: {&quot;dev&quot;: {&quot;major&quot;:</span>
<span class="go">&quot;0&quot;, &quot;minor&quot;: &quot;75&quot;}, &quot;owner&quot;:</span>
<span class="go">&quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;,</span>
<span class="go">&quot;instance&quot;: &quot;1&quot;, &quot;type&quot;: &quot;namespace&quot;, &quot;pathname&quot;: &quot;/pts&quot;}}, &quot;mode&quot;: &quot;0755&quot;}}</span>
<span class="go">...</span>
<span class="go">...</span>
<span class="go">...</span>
</pre></div>
</div>
<p>We tried to backpropagate the events and relaunch the workload (in the first
terminal).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-o<span class="w"> </span>httpd.model
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">AH00557: httpd: apr_sockaddr_info_get() failed for umoci-default</span>
<span class="go">AH00558: httpd: Could not reliably determine the server’s fully qualified domain</span>
<span class="go">name, using 127.0.0.1. Set the ’ServerName’ directive globally to suppress</span>
<span class="go">this message</span>
<span class="go">[Tue Jun 03 06:37:04.248420 2025] [mpm_event:notice] [pid 1:tid 1] AH00489: Apache</span>
<span class="go">/2.4.63 (Unix) configured -- resuming normal operations</span>
<span class="go">[Tue Jun 03 06:37:04.249136 2025] [core:notice] [pid 1:tid 1] AH00094: Command</span>
<span class="go">line: ’httpd -D FOREGROUND’</span>
<span class="go">127.0.0.1 - - [03/Jun/2025:06:37:36 +0000] &quot;GET / HTTP/1.1&quot; 304 -</span>
<span class="go">^C[Tue Jun 03 06:39:02.019698 2025] [mpm_event:notice] [pid 1:tid 1] AH00491:</span>
<span class="go">caught SIGTERM, shutting down</span>
<span class="go">Wrote security model to: httpd.model</span>
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model<span class="w"> </span>-e
<span class="go">time=&quot;2025-06-03T06:39:17Z&quot; level=warning msg=&quot;unable to terminate initProcess&quot;</span>
<span class="go">error=&quot;operation not permitted&quot;</span>
<span class="go">...</span>
<span class="go">...</span>
<span class="go">...</span>
<span class="gp"># </span>quixote-console<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-M<span class="w"> </span>-u<span class="w"> </span>&gt;<span class="w"> </span>httpd.model
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model<span class="w"> </span>-e
<span class="gp"># </span>quixote<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-m<span class="w"> </span>httpd.model<span class="w"> </span>-e
<span class="go">httpd: Could not open configuration file /usr/local/apache2/conf/httpd.conf:</span>
<span class="go">Operation not permitted time=&quot;2025-06-03T07:21:20Z&quot; level=warning msg=&quot;unable</span>
<span class="go">to destroy container: unable to remove container state dir: unlinkat</span>
<span class="go">/run/runc/httpd/state.json: operation not permitted&quot;</span>
<span class="gp">#</span>
</pre></div>
</div>
<p>Again, we got denied access. This time when inspeced in the <code class="docutils literal notranslate"><span class="pre">quixote-console</span></code>
we got less forensic events.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>quixote-console<span class="w"> </span>-w<span class="w"> </span>httpd<span class="w"> </span>-F<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l
<span class="go">4</span>
</pre></div>
</div>
<p>For illustration, we will show one of the generated events.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{</span>
<span class="go">  &quot;event&quot;: {</span>
<span class="go">        &quot;context&quot;: &quot;34&quot;,</span>
<span class="go">        &quot;number&quot;: &quot;1129&quot;,</span>
<span class="go">        &quot;process&quot;: &quot;httpd&quot;,</span>
<span class="go">        &quot;type&quot;: &quot;socket_connect&quot;,</span>
<span class="go">        &quot;ttd&quot;: &quot;2064&quot;,</span>
<span class="go">        &quot;p_ttd&quot;: &quot;2061&quot;,</span>
<span class="go">        &quot;task_id&quot;: &quot;44923b933d77a6fbc903ba3488c6b7ffdc6e7838ddea60fb5b3ec310b71ac454&quot;,</span>
<span class="go">        &quot;p_task_id&quot;: &quot;0c405f59cd464e9085e3355b2e15609b3d5ce8c1b3571ccb5de017bdded9f2d6&quot;,</span>
<span class="go">        &quot;ts&quot;: &quot;993627013&quot;</span>
<span class="go">  },</span>
<span class="go">  &quot;COE&quot;: {</span>
<span class="go">        &quot;uid&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;euid&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;suid&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;gid&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;egid&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;sgid&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;fsuid&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;fsgid&quot;: &quot;0&quot;,</span>
<span class="go">        &quot;capeff&quot;: &quot;0x200004eb&quot;</span>
<span class="go">  },</span>
<span class="go">  &quot;socket_connect&quot;: {</span>
<span class="go">        &quot;sock&quot;: {</span>
<span class="go">          &quot;family&quot;: &quot;10&quot;,</span>
<span class="go">          &quot;type&quot;: &quot;2&quot;,</span>
<span class="go">          &quot;protocol&quot;: &quot;17&quot;,</span>
<span class="go">          &quot;owner&quot;: &quot;44923b933d77a6fbc903ba3488c6b7ffdc6e7838ddea60fb5b3ec310b71ac454&quot;</span>
<span class="go">        },</span>
<span class="go">        &quot;addr&quot;: {</span>
<span class="go">          &quot;af_inet6&quot;: {</span>
<span class="go">                &quot;port&quot;: &quot;0&quot;,</span>
<span class="go">                &quot;flow&quot;: &quot;0&quot;,</span>
<span class="go">                &quot;scope&quot;: &quot;1201569384&quot;,</span>
<span class="go">                &quot;address&quot;: &quot;0000000000000000ffffff7f00000000&quot;</span>
<span class="go">          }</span>
<span class="go">        }</span>
<span class="go">  }</span>
<span class="go">}</span>
</pre></div>
</div>
<p>It shows that the denial was caused by the web server trying to connext to an
IPv6 address.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="execute_mode.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Execute mode</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="process_mode.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Process mode</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Roland Holik
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Container mode</a><ul>
<li><a class="reference internal" href="#minimalistic-debain-buster">Minimalistic Debain Buster</a></li>
<li><a class="reference internal" href="#apache-web-server">Apache web server</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=283e6f7d"></script>
    </body>
</html>